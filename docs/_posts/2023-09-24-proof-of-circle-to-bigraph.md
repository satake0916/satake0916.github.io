---
layout: post
title: 閉路が全て偶数長であることと二部グラフであることの同値性の証明
date: 2023-09-24 13:15:22 +09:00
categories: graph
tags: グラフ理論、二部グラフ
latex: true
---

グラフ$G$について、

* A: 閉路が全て偶数長であること
* B: 二部グラフであること

とします。

## AならばBの証明

最初すべての頂点が白色であるとし、全ての頂点を赤か黒に塗分けていきます。ただし同じ色が隣り合ってはいけません。

白色である頂点$v$に着目します。

最初$v$の連結成分に含まれる全ての頂点（以降$vset$と呼びます）はまだ白色ですので、$v$を赤色で塗ってしまいます。そして隣接する頂点を黒で塗り、それらから隣接する頂点を赤で塗り...という風に$vset$を全て塗っていきます。

順番は適当で構いませんが、分かりやすさのために深さ優先探索で塗っていくことにします。

ここで気になる点として、同じ色が隣り合うことはないのか？ということです。

同じ色が隣り合ってしまうのは、一般性を失わず「$v_a$を赤で塗ったので隣接する$v_b$を黒で塗ろうとしたら、$v_b$の隣接頂点である$v_c$がすでに黒だった」というシチュエーションです。この状況を仮定します。

このとき$v_c$がすでに塗られていることから、$v_a$と$v_c$を結ぶ道として$v_b$を含まないものが存在します。すなわち$v_a, v_b, v_c$を含むような閉路が存在するということです。

$v_a$は赤で$v_c$は黒ですから、$v_a$から$v_c$への道の長さは奇数長です。よってこの道に$(v_a, v_b)$と$(v_b, v_c)$を加えた閉路も奇数長です。

一方条件Aより任意の閉路は偶数長ですので、これは矛盾です。

したがって仮定したようなシチュエーションが発生することはなく、$vset$は赤か黒で塗り分けることができます。

他の連結成分についても同様の議論が成り立ち、グラフ$G$は赤と黒に塗分けられる、つまり二部グラフであることが示せました。

## BならばAの証明

$G$は二部グラフなので、Gの頂点集合は互いに素な頂点集合$V_1, V_2$に分けたうえで全ての辺が$V_1$と$V_2$の点を結んだものとできます。

閉路には$V_1$の頂点と$V_2$の頂点が交互に含まれるので、その長さは必ず偶数になります。

## 参考

* [グラフ理論入門][wilson]
  * BならばAの証明はこちらを参考にしました。AならばBの証明が演習問題 5.3になっています。

[wilson]: https://www.amazon.co.jp/%E3%82%B0%E3%83%A9%E3%83%95%E7%90%86%E8%AB%96%E5%85%A5%E9%96%80-R-J-%E3%82%A6%E3%82%A3%E3%83%AB%E3%82%BD%E3%83%B3/dp/4764902966
